[{"name":"app.R","content":"library(shiny)\nlibrary(bslib)\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(dplyr)\n\ncustom_theme <- bs_theme(\n  font_scale = .8\n)\n\n# Define UI for application that draws a histogram\nui <- page_fixed(\n  theme = custom_theme, \n    card(\n      card_header(\"Erst- vs. Drittklässler\", class = \"bg-dark\"),\n      card_body(\n          card(shinycssloaders::withSpinner(\n               plotOutput(\"plot1\", \n                          width = \"300px\",\n                          height = \"300px\"),\n               color = \"#8cd000\")\n               ),\n        layout_columns(\n          actionButton(\"smaller_plot1\",  icon(\"scale-balanced\")),\n          actionButton(\"larger_plot1\",  icon(\"scale-unbalanced\")))\n      ))\n)\n\n# Define server logic required to draw a histogram\ndistribution_normal <- function(n,\n            mean = 0,\n            sd = 1,\n            random = FALSE,\n            ...){\n    if (random) {\n      stats::rnorm(n, mean, sd)\n    }\n    else {\n      stats::qnorm(stats::ppoints(n), mean, sd, ...)\n    }\n  }\n\nserver <- function(input, output) {\n  \n  data1 <- reactive({\n    tibble(`Erstklässler` = distribution_normal(300, 121, 7.9),\n           `Zweitklässler` = distribution_normal(300, 121, 7.9) +\n             max(1.6*input$larger_plot1 - 1.6*input$smaller_plot1, 0)\n    ) %>% \n      gather(Klasse, `Körpergröße in cm`)\n  })\n  \n  output$plot1 <- renderPlot({\n      ggplot(data1(), aes(x = `Körpergröße in cm`)) +\n      #geom_dotplot(binaxis = \"x\",\n      #             stackdir = \"up\",\n      #             dotsize = .7) + \n      geom_histogram() +\n      facet_wrap(~Klasse, ncol = 1) +\n      theme_minimal(base_size = 12) +\n      ylab(\"\") +\n      ggtitle(paste0(\"Aktuelle Überlappung = \", round(2*pnorm(-abs(cohend())/2), 2)*100, \"%\"))\n                    \n  })\n  \n  cohend <- reactive({\n    (data1() %>% \n       filter(Klasse == \"Erstklässler\") %>% \n       pull(`Körpergröße in cm`) %>% \n       mean(.) - \n       data1() %>% \n       filter(Klasse == \"Zweitklässler\") %>% \n       pull(`Körpergröße in cm`) %>% \n       mean(.))/15\n  })\n  \n  output$debug <- renderPrint({\n    paste0(\"Aktuelle Überlappung = \", round(2*pnorm(-abs(cohend())/2), 2)*100, \"%\")\n  })\n}   \n\n\n# Run the application \nshinyApp(ui = ui, server = server)\n","type":"text"}]
